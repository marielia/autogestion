<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated 08-abr-2008 18:45:56 by Hibernate Tools 3.2.0.beta7 -->
<hibernate-mapping>
    <class name="com.refinor.extranet.data.Mautorizacion" table="MAutorizacion" schema="dbo" >
        <id name="codigo" type="int">
            <column name="codigo" />
            <generator class="identity" />
        </id>
        <property name="codVendedor" type="java.lang.Integer">
            <column name="codVendedor" />
        </property>
        <property name="codCcss" type="java.lang.Integer">
            <column name="codCCSS" />
        </property>
        <property name="codCliente" type="java.lang.Integer">
            <column name="codCliente" />
        </property>
        <property name="codMotivo" type="java.lang.Integer">
            <column name="codMotivo" />
        </property>
        <property name="descripcion" type="string">
            <column name="descripcion" length="200" not-null="true" />
        </property>
        <property name="codChofer" type="java.lang.Integer">
            <column name="codChofer" />
        </property>
        <property name="codVehiculo" type="java.lang.Integer">
            <column name="codVehiculo" />
        </property>
        <property name="nroRemito1" type="java.lang.Integer">
            <column name="nroRemito1" />
        </property>
        <property name="nroRemito2" type="java.lang.Integer">
            <column name="nroRemito2" />
        </property>
        <property name="codTipoAuto" type="java.lang.Integer">
            <column name="codTipoAuto" />
        </property>
        <property name="fecha" type="timestamp">
            <column name="fecha" length="23" />
        </property>
        <property name="idCodigoAuto" type="java.lang.Integer">
            <column name="idCodigoAuto" />
        </property>
        <property name="codEmisor" type="java.lang.Integer">
            <column name="codEmisor" />
        </property>
        <property name="codDescripcion" type="java.lang.Integer">
            <column name="codDescripcion" />
        </property>
        <property name="litrosAcargar" type="big_decimal">
            <column name="litrosACargar" scale="4" />
        </property>
        <property name="tipoComprobanteManual" type="java.lang.Integer">
            <column name="TipoComprobanteManual" />
        </property>
        <property name="tipoComprobanteAnular" type="java.lang.Integer">
            <column name="TipoComprobanteAnular" />
        </property>
        <property name="producto" type="java.lang.Integer">
            <column name="Producto" />
        </property>
        <property name="fechaPedido" type="timestamp">
            <column name="FechaPedido" length="23" />
        </property>
        <property name="sucursalManual" type="java.lang.Integer">
            <column name="SucursalManual" />
        </property>
        <property name="sucursalAnular" type="java.lang.Integer">
            <column name="SucursalAnular" />
        </property>
    </class>
    
    <sql-query name="findAutorizacionesPorFiltro">
    	<query-param name="codVendedor" type="integer"/>
		<query-param name="codCcss" type="integer"/>
		<query-param name="codCliente" type="integer"/>
		<query-param name="codMotivo" type="integer"/>
		<query-param name="codDescripcion" type="integer"/>
		<query-param name="codChofer" type="integer"/>
		<query-param name="codVehiculo" type="integer"/>
		<query-param name="fechaDesde" type="timestamp"/>
		<query-param name="fechaHasta" type="timestamp"/>
		
		<query-param name="codProducto" type="integer"/>
		<query-param name="tipoCompManual" type="integer"/>
		<query-param name="nroAutorizacion" type="string"/>
		<query-param name="sucursalManual" type="integer"/>		
		<query-param name="nroRemito1" type="integer"/>
		<query-param name="codAutorizacion" type="integer"/>
		<query-param name="codEmpleado" type="integer"/>
		
		
		select 
		au.codigo as aucod,
		v.codigo as vcod,
		v.apellido as vape,
		v.nombre as vnom,
		
		c.cod_ccss as codccss,
		c.desc_ccss ccssdes,
		
		cl.codigo as codCli,
		cl.descripcion as codDes,
		
		a.codigo as acod,
		a.descripcion aDesc,
		
		d.codigo as dcod,
		d.descripcion as ddesc,
		
		ch.codigo as chcod,
		ch.apellido as chape,
		ch.nombre as chnom,
		
		ve.codigo as vecod,
		ve.dominio as vedom,
		
		au.fecha as aufech,
		isnull(au.nroRemito1,0) as aunrorem1,
		isnull(au.nroRemito2,0) as aunrorem2,
		au.idCodigoAuto as codAuto,
		ac.nro_auto as nroAutor,
		isnull(au.litrosacargar,0) as litros,
		
		au.fechaPedido as fechaped,
		
		au.TipoComprobanteManual as tipocomm,
		cm.nombre as tcmnom,
		
		isnull(au.TipoComprobanteAnular,0) as tca,
		
		au.Producto as prod,
		ar.descripcion as proddesc,
		
		au.SucursalManual as sucm,
		
		isnull(au.SucursalAnular,0) as suca,
		ac.f_usado as fechaUsado,
		au.codEmisor as codEmisor
		
		from mautorizacion au,
		mvendedor v,
		mccss c,
		mclientes cl,
		mAutorizacionMotivo a,
		mDescripcionMotivoAutorizacion d,
		mChofer ch,
		mVehiculo ve,
		mAutorizacionCodigos ac,
		tipoComprobante cm,
		mArticulos ar	
		
		where 
		(au.codigo = :codAutorizacion or :codAutorizacion = -1) and
		v.codigo = au.codVendedor and
		(au.codVendedor = :codVendedor or :codVendedor = -1) and
		
		c.cod_ccss = au.codCcss and
		(au.codCcss = :codCcss or :codCcss = -1) and 
		
		cl.codigo = au.codCliente and
		(au.codCliente = :codCliente or :codCliente = -1) and
		
		a.codigo = au.codMotivo and
		(au.codMotivo = :codMotivo or :codMotivo = -1) and
		
		d.codigo = au.codDescripcion and
		(au.codDescripcion = :codDescripcion or :codDescripcion = -1) and
		
		ch.codigo = au.codChofer and
		(au.codChofer = :codChofer or :codChofer = -1) and
		
		ve.codigo = au.codVehiculo and
		(au.codVehiculo = :codVehiculo or :codVehiculo = -1) and
		
		(au.fechaPedido between :fechaDesde and :fechaHasta or 
		:fechaDesde is null and :fechaHasta is null) and
		
		cm.id = au.TipoComprobanteManual and
		(au.TipoComprobanteManual = :tipoCompManual or :tipoCompManual = -1) and
		
		ar.codigo = au.producto and
		(au.producto = :codProducto or :codProducto = -1) and
		
		au.idCodigoAuto = ac.codigo and
		(ac.nro_auto like :nroAutorizacion) and
		
		(au.SucursalManual = :sucursalManual or :sucursalManual = -1) and
		(au.nroRemito1  = :nroRemito1 or :nroRemito1 = -1) and
		
		(au.codEmisor  = :codEmpleado or :codEmpleado = -1) 
		
		order by au.fechaPedido desc
		
		
    </sql-query>
    
    <sql-query name="findAutorizacionesPorSucYNroCompr">
    	<query-param name="nroSucursal" type="integer"/>
		<query-param name="codCcss" type="integer"/>
			select 
			a.codigo as aucod,
			a.sucursalManual as sucManual,
			a.nroRemito1  as remitoManual
			
			from Mautorizacion a
			where a.sucursalManual = :nroSucursal
			and a.nroRemito1 = :codComprobante
	</sql-query>
    
    
    
    
    
</hibernate-mapping>
