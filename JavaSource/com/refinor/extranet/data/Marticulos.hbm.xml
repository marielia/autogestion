<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated 22-may-2008 14:13:11 by Hibernate Tools 3.2.0.beta7 -->
<hibernate-mapping>
    <class name="com.refinor.extranet.data.Marticulos" table="Marticulos" schema="dbo" >
        <id name="codigo" type="int">
            <column name="Codigo" />
            <generator class="assigned" />
        </id>
        <property name="codFacturaC" type="java.lang.Integer">
            <column name="CodFacturaC" />
        </property>
        <property name="proveedor" type="int">
            <column name="Proveedor" not-null="true" />
        </property>
        <property name="feArrivo" type="timestamp">
            <column name="FeArrivo" length="16" not-null="true" />
        </property>
        <property name="arrivo" type="java.lang.Integer">
            <column name="Arrivo" />
        </property>
        <property name="descripcion" type="string">
            <column name="Descripcion" length="60" />
        </property>
        <property name="descripcionBreve" type="string">
            <column name="DescripcionBreve" length="20" />
        </property>
        <property name="espVar" type="int">
            <column name="EspVar" not-null="true" />
        </property>
        <property name="especie" type="int">
            <column name="Especie" not-null="true" />
        </property>
        <property name="variedad" type="int">
            <column name="Variedad" not-null="true" />
        </property>
        <property name="zona" type="java.lang.Integer">
            <column name="Zona" />
        </property>
        <property name="calidad" type="java.lang.Integer">
            <column name="Calidad" />
        </property>
        <property name="presentacion" type="java.lang.Integer">
            <column name="Presentacion" />
        </property>
        <property name="tama&#241;o" type="java.lang.Integer">
            <column name="Tama&#241;o" />
        </property>
        <property name="madurez" type="java.lang.Integer">
            <column name="Madurez" />
        </property>
        <property name="precioK" type="big_decimal">
            <column name="PrecioK" scale="4" />
        </property>
        <property name="cantidad" type="java.lang.Double">
            <column name="Cantidad" precision="53" scale="0" />
        </property>
        <property name="bultos" type="java.lang.Integer">
            <column name="Bultos" />
        </property>
        <property name="saldoK" type="java.lang.Double">
            <column name="SaldoK" precision="53" scale="0" />
        </property>
        <property name="saldoB" type="java.lang.Integer">
            <column name="SaldoB" />
        </property>
        <property name="precioDefinitivo" type="string">
            <column name="PrecioDefinitivo" length="2" />
        </property>
        <property name="idUserLock" type="java.lang.Integer">
            <column name="IdUserLock" />
        </property>
        <property name="fhBaja" type="timestamp">
            <column name="FhBaja" length="16" />
        </property>
        <property name="codiOrigen" type="java.lang.Integer">
            <column name="CodiOrigen" />
        </property>
        <property name="codBarra" type="big_decimal">
            <column name="cod_barra" precision="20" scale="0" />
        </property>
        <property name="unMedida" type="java.lang.Integer">
            <column name="un_medida" />
        </property>
        <property name="minFact" type="big_decimal">
            <column name="min_fact" precision="14" scale="4" />
        </property>
        <property name="grupoDesc" type="java.lang.Integer">
            <column name="grupo_desc" />
        </property>
        <property name="conInsu" type="java.lang.Boolean">
            <column name="con_insu" />
        </property>
        <property name="esComb" type="java.lang.Boolean">
            <column name="es_comb" />
        </property>
        <property name="alertaVto" type="java.lang.Boolean">
            <column name="alerta_vto" />
        </property>
        <property name="activo" type="java.lang.Boolean">
            <column name="activo" />
        </property>
        <property name="recManual" type="java.lang.Boolean">
            <column name="rec_manual" />
        </property>
        <property name="afectaStock" type="java.lang.Boolean">
            <column name="afecta_stock" />
        </property>
        <property name="esGasoil" type="java.lang.Boolean">
            <column name="es_gasoil" />
        </property>
    </class>
    
    <query name="findArticulos">
         from Marticulos 
         order by descripcion
     </query>
     
      <query name="findProductoPorDescripcion">
         FROM Marticulos 
         WHERE  LTRIM(RTRIM(UPPER(descripcion))) like LTRIM(RTRIM(UPPER(:descripcion))) 
     </query>
     
      <sql-query name="findFamilias">
        SELECT codigo, descripcion FROM MEspecies WHERE FhBaja is null
      </sql-query>
      
      <sql-query name="findGrupos">
        SELECT variedad, variedadD FROM MVariedades WHERE FhBaja is null
      </sql-query>
      
        <query name="findArticulosEsCombo">
         from Marticulos 
         where fhbaja is null and es_comb = 1
         order by descripcion
     </query>
     
     
       <sql-query name="findArticulosLimiteCarga"> 
		  <query-param name="codVehiculo" type="integer" />
		  <query-param name="codCcss" type="integer" />
		<![CDATA[	
			 SELECT
			  a.nroAforador, 
			  convert(varchar(25),a.nroAforador) 
			 FROM 
			 MAforador a INNER JOIN MTanque t ON a.nroTanque = t.nroTanque AND t.ccss = :codCcss
			 INNER JOIN MComision co ON t.ccss = co.ccss And t.codArticulo = co.cod_art  
			 INNER JOIN (SELECT 
			 				ar.codigo  
						 FROM 
						 	mlimitecarga l INNER JOIN marticulos ar  
							 ON (l.fliaGrupArt = 'F' and l.cod_art=ar.especie)  
							 OR (l.fliaGrupArt = 'G' and l.cod_art=ar.variedad)  
							 OR (l.fliaGrupArt = 'A' and l.cod_art=ar.codigo)  
						 WHERE l.cod_veh= :codVehiculo ) lc ON lc.codigo=t.codArticulo  
			 WHERE co.f_baja Is Null And a.fhbaja Is Null And t.fhbaja Is Null
			 
		]]>	
    </sql-query>
    
      <sql-query name="findArticulosSinLimiteCarga"> 
		  <query-param name="codCcss" type="integer" />
		<![CDATA[	
			  SELECT 
			   a.nroAforador, 
			   convert(varchar(25),a.nroAforador)  
			  FROM MAforador a, MTanque t, CCSS c, MComision co 
			  WHERE a.nroTanque = t.nroTanque AND 
			  t.ccss = C.ID AND 
			  t.ccss = co.ccss AND 
			  t.codArticulo = co.cod_art AND 
			  co.ccss = :codCcss AND 
			  co.f_baja is null AND 
			  a.fhbaja is null AND 
			  t.fhbaja is null 
			 
		]]>	
    </sql-query>
     
</hibernate-mapping>
